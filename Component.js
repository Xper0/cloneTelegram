sap.ui.define(["sap/ui/core/UIComponent","sap/ui/Device","cloneTelegramApp/cloneTelegram/model/models","./model/formatter"],function(e,s,t,o){"use strict";return e.extend("cloneTelegramApp.cloneTelegram.Component",{formatter:o,metadata:{manifest:"json"},init:function(){e.prototype.init.apply(this,arguments);this.oTaskModel=this.getModel("ListTasks");this.oCommentsTask=this.getModel("CommentsTask");this.socket=new WebSocket("ws://127.0.0.1:4000");let s=sap.ui.getCore().getEventBus();this.socket.onopen=e=>{console.log("server ON")};console.log(this.socket);this.socket.onmessage=e=>{console.log(e);console.log("connect msg");try{let t=JSON.parse(e.data);if(t.type=="message"){console.log("dsds");if(t.responseId){s.publish("messages","messageResponce",t)}}if(t.type=="newMessages"){s.publish("newMessages","messageResponse",t)}}catch(e){console.dir(e)}};this.getRouter().initialize();this.setModel(t.createDeviceModel(),"device");this.loadTasks()},loadTasks:function(){return new Promise(async(e,s)=>{let t="Александр Павлов";const o=" http://127.0.0.1:5000/tasksList";this.oTaskModel=this.getModel("ListTasks");let i=await fetch(o);let l=await i.json();let a=[{title:"Все",key:"All"},{title:"Назначенные мне",key:"toMe"},{title:"Назначенные мной",key:"onMe"},{title:"Закрытые",key:"CloseTask"}];this.oTaskModel.setProperty("/tasksList",l.result);this.oTaskModel.setProperty("/tasksGroups",a);console.log(this.oTaskModel);e()})}})});