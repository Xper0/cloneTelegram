sap.ui.define(["sap/ui/core/mvc/Controller","../model/formatter","sap/ui/model/json/JSONModel","sap/ui/core/routing/History"],function(e,t,o,s){"use strict";return e.extend("cloneTelegramApp.cloneTelegram.controller.EditTask",{formatter:t,onInit:function(){let e=this.getOwnerComponent().getRouter();e.getRoute("EditTask").attachMatched(this._onObjectMatched,this)},_onObjectMatched:function(e){let t=e.getParameter("arguments").editTaskId;this.getOwnerComponent().loadTasks().then(()=>{let e=this.getOwnerComponent().getModel("ListTasks").getData().tasksList;let o=e.findIndex(e=>e.id==t);console.log(o);let s=`/tasksList/${o}`;this.getView().bindElement({path:s,model:"ListTasks"})})},onSaveTask:async function(){let e=this.byId("listSubtasks");let t=[];let o=e.getAggregation("items");o.forEach(e=>{let o=e.getAggregation("content");t.push({title:o[1].getProperty("value"),state:o[0].getProperty("selected")})});console.log(t);let s=this.getOwnerComponent().getRouter().oHashChanger.hash.substr(9);let l=this.byId("editTask");let n=l.getFormContainers()[0].getFormElements();let a={};let i=this.getOwnerComponent().getRouter();const r=" http://127.0.0.1:5000/tasksList";let g={Accept:"application/json","Access-Control-Allow-Origin":"*","X-Requested-With":"XMLHttpRequest","Access-Control-Allow-Methods":"GET,POST,PUT,DELETE,OPTIONS","Access-Control-Allow-Headers":"Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With"};debugger;n.forEach(e=>{if(e.getLabel()==="Название задачи"){a.title=e.getFields()[0].getProperty("value")}if(e.getLabel()==="Описание задачи"){a.description=e.getFields()[0].getProperty("value")}if(e.getLabel()==="Дедлайн"){let t=Math.floor(new Date(e.getFields()[0].getProperty("value")).getTime()/1e3);a.date=t}if(e.getLabel()==="Важность"){a.importance=e.getFields()[0].getProperty("value")}if(e.getLabel()==="Постановщик"){a.supervisor=e.getFields()[0].getProperty("value")}if(e.getLabel()==="Ответсвенный"){a.responsible=e.getFields()[0].getProperty("value")}a.id=s});a.subtasks=t;console.log(a);let c=await fetch(r,{method:"POST",headers:g,body:JSON.stringify({task:a})});let d=await c.json();console.log(d);i.navTo("Tasks")},onCancel:function(){}})});